<!doctype html><html lang=en-us><head><title>Rectangle (AABB) Collisions | benpm.github.io</title><meta charset=utf-8><meta name=language content="en"><meta name=description content="Simulating simple 2D game physics with axis-aligned bounding boxes"><meta name=keywords content="AABB ,2d ,collisions ,physics ,game physics"><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rectangle (AABB) Collisions"><meta name=twitter:description content="Simulating simple 2D game physics with axis-aligned bounding boxes"><meta name=twitter:site content="https://twitter.com/_bpmw"><meta name=twitter:creator content="https://twitter.com/_bpmw"><link rel="shortcut icon" type=image/png href=/favicon.ico><link type=text/css rel=stylesheet href=/css/post.min.0b2398fd36f8510cd4ceb7f789b8e68f9e7f2ffc32f5527986f4368e54deb0c4.css integrity="sha256-CyOY/Tb4UQzUzrf3ibjmj55/L/wy9VJ5hvQ2jlTesMQ="><link type=text/css rel=stylesheet href=/css/custom.min.07e9b415621806a47b49ec8c7ecdbf25587cfa93cfee5f5019087c00a2e528c1.css integrity="sha256-B+m0FWIYBqR7SeyMfs2/JVh8+pPP7l9QGQh8AKLlKME="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/benpm.github.io\/"},"articleSection":"blog","name":"Rectangle (AABB) Collisions","headline":"Rectangle (AABB) Collisions","description":"Simulating simple 2D game physics with axis-aligned bounding boxes","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2020","datePublished":"2020-07-22 22:10:40 -0600 -0600","dateModified":"2020-07-22 22:10:40 -0600 -0600","url":"https:\/\/benpm.github.io\/blog\/2d-top-down-collisions-with-rectangles-aabbs\/","wordCount":"316","keywords":["AABB","2d","collisions","physics","game physics","Blog"]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PPST2B8G8Z"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-PPST2B8G8Z');</script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=/>splash ★</a><div class=indicator></div></li><li><a class=active href=/blog>blog</a><div class="indicator active"></div></li><li><a href=/experiments>experiments</a><div class=indicator></div></li><li><a href=/gamedev>gamedev</a><div class=indicator></div></li><li><a href=/music>music</a><div class=indicator></div></li><li><a href=/projects>projects</a><div class=indicator></div></li><li><a href=https://github.com/benpm/cv/raw/master/benpm_cv.pdf>cv ⭳</a><div class=indicator></div></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>Rectangle (AABB) Collisions</h1><time datetime="2020-07-22 22:10:40 -0600 -0600" class=post-date>Jul 22 2020</time></header><article class=post__content><p>Axis-aligned bounding boxes (AABBs) are very useful for doing simple collision detection and 2D physics.
The basic idea is: loop through the boxes, checking for intersections with each other box. Then, you resolve
these intersections by moving the boxes in the direction of the shortest intersection axis. So if the width
of the intersection is smaller than its height, like it is here, then the boxes are moved on the x axis:</p><p><img class="invertable drawing" src=/images/aabb/boxes.png alt></p><p>I will be using these types of collisions for the game I am developing. The game is top-down. It looks like this:</p><p><img src=/images/2020-07-22_23-41.png alt></p><p>So the physics doesn&rsquo;t actually need to have fancy features like bounce (restitution). What it does need is
to be stable and fast.</p><p>There are a couple things I&rsquo;ll need to do to acheive both of these goals. First, I&rsquo;ll need to make it stable. Without any modifications, the simple collision algorithm creates far too much jiggliness, especially when there are a lot of boxes pushing on each other all at once. This happens because during a collision pass, a box may be pushed by a collision into another box, causing an intersection. However, this intersection won&rsquo;t be resolved until the next pass.</p><p><img class="invertable drawing" src=/images/aabb/boxes2.png alt></p><p>In order to solve this issue, I&rsquo;ve decided to run multiple passes of collision resolution on the boxes before each
update step. The update step is where velocity is applied to position, friction is applied, etc.
Here is the result of using multiple passes:</p><p class=codepen data-height=431 data-theme-id=light data-default-tab=result data-user=_bm data-slug-hash=xxZMjXb style="height:431px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:2em 0;padding:1em" data-pen-title="AABB Collisions Test"></p><script async src=https://static.codepen.io/assets/embed/ei.js></script><p>As you can see, there are still some minor issues. When a constant force is applied, the boxes vibrate slightly. Also, when there is a big pile, they tend to overlap. It&rsquo;s also pretty slow, since each box needs to check against each other box each collision pass, and there are multiple collision passes now.</p><p>To solve this issue with speed, I&rsquo;ll probably end up using <a href=https://www.wikiwand.com/en/Quadtree target=_blank rel="noreferrer noopener">quadtrees</a> for neighbor lookup, but that&rsquo;s for another time!</p></article><ul class=tags__list><li class=tag__item><a class=tag__link href=https://benpm.github.io/tags/math/>math</a></li><li class=tag__item><a class=tag__link href=https://benpm.github.io/tags/tiletest/>tiletest</a></li><li class=tag__item><a class=tag__link href=https://benpm.github.io/tags/gamedev/>gamedev</a></li><li class=tag__item><a class=tag__link href=https://benpm.github.io/tags/game-physics/>game-physics</a></li></ul><div class=pagination><a class=pagination__item href=https://benpm.github.io/blog/hello_world/><span class=pagination__label>Previous Post</span>
<span class=pagination__title>Hello World!</span></a>
<a class=pagination__item href=https://benpm.github.io/blog/gol_1/><span class=pagination__label>Next Post</span>
<span class=pagination__title>Cellular Automata in WebGL: Part 1</span></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link title=Twitter href=https://twitter.com/_bpmw target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://benpm.github.io/svg/twitter.svg)></div></a><a class=social-icons__link title=GitHub href=https://github.com/benpm target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://benpm.github.io/svg/github.svg)></div></a><a class=social-icons__link title=YouTube href=https://www.youtube.com/c/BenjaminMastripolito target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://benpm.github.io/svg/youtube.svg)></div></a><a class=social-icons__link title=SoundCloud href=https://soundcloud.com/trope target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://benpm.github.io/svg/soundcloud.svg)></div></a><a class=social-icons__link title=ItchIO href=https://ben-m.itch.io/ target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://benpm.github.io/svg/itchio.svg)></div></a><a class=social-icons__link title=ko-fi href=https://ko-fi.com/benpm target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://benpm.github.io/svg/ko-fi.svg)></div></a></div><p></p></footer></div></div></div></main><script src=/js/index.min.49e4d8a384357d9b445b87371863419937ede9fa77737522ffb633073aebfa44.js integrity="sha256-SeTYo4Q1fZtEW4c3GGNBmTft6fp3c3Ui/7YzBzrr+kQ=" crossorigin=anonymous></script><script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script><script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script><script src=/js/theme_toggle.min.849493ff7ff93f4d1ced5d05d4e096c9968165968b41ebbe21a57f3690305a10.js integrity="sha256-hJST/3/5P00c7V0F1OCWyZaBZZaLQeu+IaV/NpAwWhA=" crossorigin=anonymous></script><div id=theme-toggle-button class=invertable onclick=toggleTheme()></div></body></html>